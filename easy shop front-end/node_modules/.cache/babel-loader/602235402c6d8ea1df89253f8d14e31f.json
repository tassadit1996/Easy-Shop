{"ast":null,"code":"var _this = this;\n\nimport React, { Fragment, useCallback, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport Image from './components/Image';\nimport ZoomImage from './components/ZoomImage';\nimport FullscreenPortal from './components/FullscreenPortal';\n\nvar InnerImageZoom = function InnerImageZoom(_ref) {\n  var _ref$moveType = _ref.moveType,\n      moveType = _ref$moveType === void 0 ? 'pan' : _ref$moveType,\n      _ref$zoomType = _ref.zoomType,\n      zoomType = _ref$zoomType === void 0 ? 'click' : _ref$zoomType,\n      src = _ref.src,\n      srcSet = _ref.srcSet,\n      sizes = _ref.sizes,\n      sources = _ref.sources,\n      width = _ref.width,\n      height = _ref.height,\n      hasSpacer = _ref.hasSpacer,\n      zoomSrc = _ref.zoomSrc,\n      _ref$zoomScale = _ref.zoomScale,\n      zoomScale = _ref$zoomScale === void 0 ? 1 : _ref$zoomScale,\n      zoomPreload = _ref.zoomPreload,\n      alt = _ref.alt,\n      _ref$fadeDuration = _ref.fadeDuration,\n      fadeDuration = _ref$fadeDuration === void 0 ? 150 : _ref$fadeDuration,\n      fullscreenOnMobile = _ref.fullscreenOnMobile,\n      _ref$mobileBreakpoint = _ref.mobileBreakpoint,\n      mobileBreakpoint = _ref$mobileBreakpoint === void 0 ? 640 : _ref$mobileBreakpoint,\n      hideCloseButton = _ref.hideCloseButton,\n      hideHint = _ref.hideHint,\n      className = _ref.className,\n      afterZoomIn = _ref.afterZoomIn,\n      afterZoomOut = _ref.afterZoomOut;\n  var img = useRef(null);\n  var zoomImg = useRef(null);\n  var imgProps = useRef({});\n\n  var _useState = useState(zoomPreload),\n      isActive = _useState[0],\n      setIsActive = _useState[1];\n\n  var _useState2 = useState(false),\n      isTouch = _useState2[0],\n      setIsTouch = _useState2[1];\n\n  var _useState3 = useState(false),\n      isZoomed = _useState3[0],\n      setIsZoomed = _useState3[1];\n\n  var _useState4 = useState(false),\n      isFullscreen = _useState4[0],\n      setIsFullscreen = _useState4[1];\n\n  var _useState5 = useState(false),\n      isDragging = _useState5[0],\n      setIsDragging = _useState5[1];\n\n  var _useState6 = useState(false),\n      isValidDrag = _useState6[0],\n      setIsValidDrag = _useState6[1];\n\n  var _useState7 = useState(moveType),\n      currentMoveType = _useState7[0],\n      setCurrentMoveType = _useState7[1];\n\n  var _useState8 = useState(0),\n      left = _useState8[0],\n      setLeft = _useState8[1];\n\n  var _useState9 = useState(0),\n      top = _useState9[0],\n      setTop = _useState9[1];\n\n  var handleMouseEnter = function handleMouseEnter(e) {\n    setIsActive(true);\n    zoomType === 'hover' && !isZoomed && handleClick(e);\n  };\n\n  var handleTouchStart = function handleTouchStart() {\n    setIsTouch(true);\n    setIsFullscreen(getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint));\n    setCurrentMoveType('drag');\n  };\n\n  var handleClick = function handleClick(e) {\n    if (isZoomed) {\n      if (isTouch) {\n        hideCloseButton && handleClose();\n      } else {\n        !isValidDrag && zoomOut();\n      }\n\n      return;\n    }\n\n    isTouch && setIsActive(true);\n\n    if (zoomImg.current) {\n      handleLoad({\n        target: zoomImg.current\n      });\n      zoomIn(e.pageX, e.pageY);\n    } else {\n      imgProps.current.onLoadCallback = zoomIn.bind(_this, e.pageX, e.pageY);\n    }\n  };\n\n  var handleLoad = function handleLoad(e) {\n    var scaledDimensions = getScaledDimensions(e.target, zoomScale);\n    zoomImg.current = e.target;\n    zoomImg.current.setAttribute('width', scaledDimensions.width);\n    zoomImg.current.setAttribute('height', scaledDimensions.height);\n    imgProps.current.scaledDimensions = scaledDimensions;\n    imgProps.current.bounds = getBounds(img.current, false);\n    imgProps.current.ratios = getRatios(imgProps.current.bounds, scaledDimensions);\n\n    if (imgProps.current.onLoadCallback) {\n      imgProps.current.onLoadCallback();\n      imgProps.current.onLoadCallback = null;\n    }\n  };\n\n  var handleMouseMove = function handleMouseMove(e) {\n    var left = e.pageX - imgProps.current.offsets.x;\n    var top = e.pageY - imgProps.current.offsets.y;\n    left = Math.max(Math.min(left, imgProps.current.bounds.width), 0);\n    top = Math.max(Math.min(top, imgProps.current.bounds.height), 0);\n    setLeft(left * -imgProps.current.ratios.x);\n    setTop(top * -imgProps.current.ratios.y);\n  };\n\n  var handleDragStart = function handleDragStart(e) {\n    imgProps.current.offsets = getOffsets(e.pageX || e.changedTouches[0].pageX, e.pageY || e.changedTouches[0].pageY, zoomImg.current.offsetLeft, zoomImg.current.offsetTop);\n    setIsDragging(true);\n\n    if (!isTouch) {\n      imgProps.current.eventPosition = {\n        x: e.pageX,\n        y: e.pageY\n      };\n    }\n  };\n\n  var handleDragMove = useCallback(function (e) {\n    var left = (e.pageX || e.changedTouches[0].pageX) - imgProps.current.offsets.x;\n    var top = (e.pageY || e.changedTouches[0].pageY) - imgProps.current.offsets.y;\n    left = Math.max(Math.min(left, 0), (imgProps.current.scaledDimensions.width - imgProps.current.bounds.width) * -1);\n    top = Math.max(Math.min(top, 0), (imgProps.current.scaledDimensions.height - imgProps.current.bounds.height) * -1);\n    setLeft(left);\n    setTop(top);\n  }, []);\n\n  var handleDragEnd = function handleDragEnd(e) {\n    setIsDragging(false);\n\n    if (!isTouch) {\n      var moveX = Math.abs(e.pageX - imgProps.current.eventPosition.x);\n      var moveY = Math.abs(e.pageY - imgProps.current.eventPosition.y);\n      setIsValidDrag(moveX > 5 || moveY > 5);\n    }\n  };\n\n  var handleMouseLeave = function handleMouseLeave(e) {\n    currentMoveType === 'drag' && isZoomed ? handleDragEnd(e) : handleClose();\n  };\n\n  var handleClose = function handleClose() {\n    zoomOut(function () {\n      setTimeout(function () {\n        if (zoomPreload && isTouch || !zoomPreload) {\n          zoomImg.current = null;\n          imgProps.current = getDefaults();\n          setIsActive(false);\n        }\n\n        setIsTouch(false);\n        setIsFullscreen(false);\n        setCurrentMoveType(moveType);\n      }, isFullscreen ? 0 : fadeDuration);\n    });\n  };\n\n  var initialMove = function initialMove(pageX, pageY) {\n    imgProps.current.offsets = getOffsets(window.pageXOffset, window.pageYOffset, -imgProps.current.bounds.left, -imgProps.current.bounds.top);\n    handleMouseMove({\n      pageX: pageX,\n      pageY: pageY\n    });\n  };\n\n  var initialDrag = function initialDrag(pageX, pageY) {\n    var initialPageX = (pageX - (window.pageXOffset + imgProps.current.bounds.left)) * -imgProps.current.ratios.x;\n    var initialPageY = (pageY - (window.pageYOffset + imgProps.current.bounds.top)) * -imgProps.current.ratios.y;\n    initialPageX = initialPageX + (isFullscreen ? (window.innerWidth - imgProps.current.bounds.width) / 2 : 0);\n    initialPageY = initialPageY + (isFullscreen ? (window.innerHeight - imgProps.current.bounds.height) / 2 : 0);\n    imgProps.current.bounds = getBounds(img.current, isFullscreen);\n    imgProps.current.offsets = getOffsets(0, 0, 0, 0);\n    handleDragMove({\n      changedTouches: [{\n        pageX: initialPageX,\n        pageY: initialPageY\n      }],\n      preventDefault: function preventDefault() {},\n      stopPropagation: function stopPropagation() {}\n    });\n  };\n\n  var zoomIn = function zoomIn(pageX, pageY) {\n    setIsZoomed(true);\n    currentMoveType === 'drag' ? initialDrag(pageX, pageY) : initialMove(pageX, pageY);\n    afterZoomIn && afterZoomIn();\n  };\n\n  var zoomOut = function zoomOut(callback) {\n    setIsZoomed(false);\n    afterZoomOut && afterZoomOut();\n    callback && callback();\n  };\n\n  var getDefaults = function getDefaults() {\n    return {\n      onLoadCallback: null,\n      bounds: {},\n      offsets: {},\n      ratios: {},\n      eventPosition: {},\n      scaledDimensions: {}\n    };\n  };\n\n  var getBounds = function getBounds(img, isFullscreen) {\n    if (isFullscreen) {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        left: 0,\n        top: 0\n      };\n    }\n\n    return img.getBoundingClientRect();\n  };\n\n  var getOffsets = function getOffsets(pageX, pageY, left, top) {\n    return {\n      x: pageX - left,\n      y: pageY - top\n    };\n  };\n\n  var getRatios = function getRatios(bounds, dimensions) {\n    return {\n      x: (dimensions.width - bounds.width) / bounds.width,\n      y: (dimensions.height - bounds.height) / bounds.height\n    };\n  };\n\n  var getFullscreenStatus = function getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint) {\n    return fullscreenOnMobile && window.matchMedia && window.matchMedia(\"(max-width: \" + mobileBreakpoint + \"px)\").matches;\n  };\n\n  var getScaledDimensions = function getScaledDimensions(zoomImg, zoomScale) {\n    return {\n      width: zoomImg.naturalWidth * zoomScale,\n      height: zoomImg.naturalHeight * zoomScale\n    };\n  };\n\n  var zoomImageProps = {\n    src: zoomSrc || src,\n    fadeDuration: isFullscreen ? 0 : fadeDuration,\n    top: top,\n    left: left,\n    isZoomed: isZoomed,\n    onLoad: handleLoad,\n    onDragStart: currentMoveType === 'drag' ? handleDragStart : null,\n    onDragEnd: currentMoveType === 'drag' ? handleDragEnd : null,\n    onClose: !hideCloseButton && isTouch ? handleClose : null\n  };\n  useEffect(function () {\n    imgProps.current = getDefaults();\n  }, []);\n  useEffect(function () {\n    getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint) && setIsActive(false);\n  }, [fullscreenOnMobile, mobileBreakpoint]);\n  useEffect(function () {\n    if (!zoomImg.current) {\n      return;\n    }\n\n    var eventType = isTouch ? 'touchmove' : 'mousemove';\n\n    if (isDragging) {\n      zoomImg.current.addEventListener(eventType, handleDragMove, {\n        passive: true\n      });\n    } else {\n      zoomImg.current.removeEventListener(eventType, handleDragMove);\n    }\n  }, [isDragging, isTouch, handleDragMove]);\n  return /*#__PURE__*/React.createElement(\"figure\", {\n    className: \"iiz \" + (currentMoveType === 'drag' ? 'iiz--drag' : '') + \" \" + (className ? className : ''),\n    style: {\n      width: width\n    },\n    ref: img,\n    onTouchStart: isZoomed ? null : handleTouchStart,\n    onClick: handleClick,\n    onMouseEnter: isTouch ? null : handleMouseEnter,\n    onMouseMove: currentMoveType === 'drag' || !isZoomed ? null : handleMouseMove,\n    onMouseLeave: isTouch ? null : handleMouseLeave\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: src,\n    srcSet: srcSet,\n    sizes: sizes,\n    sources: sources,\n    width: width,\n    height: height,\n    hasSpacer: hasSpacer,\n    alt: alt,\n    fadeDuration: fadeDuration,\n    isZoomed: isZoomed\n  }), isActive && /*#__PURE__*/React.createElement(Fragment, null, isFullscreen ? /*#__PURE__*/React.createElement(FullscreenPortal, null, /*#__PURE__*/React.createElement(ZoomImage, zoomImageProps)) : /*#__PURE__*/React.createElement(ZoomImage, zoomImageProps)), !hideHint && !isZoomed && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"iiz__btn iiz__hint\"\n  }));\n};\n\nInnerImageZoom.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  moveType: PropTypes.string,\n  zoomType: PropTypes.string,\n  src: PropTypes.string.isRequired,\n  srcSet: PropTypes.string,\n  sizes: PropTypes.string,\n  sources: PropTypes.array,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  hasSpacer: PropTypes.bool,\n  zoomSrc: PropTypes.string,\n  zoomScale: PropTypes.number,\n  zoomPreload: PropTypes.bool,\n  alt: PropTypes.string,\n  fadeDuration: PropTypes.number,\n  fullscreenOnMobile: PropTypes.bool,\n  mobileBreakpoint: PropTypes.number,\n  hideCloseButton: PropTypes.bool,\n  hideHint: PropTypes.bool,\n  className: PropTypes.string,\n  afterZoomIn: PropTypes.func,\n  afterZoomOut: PropTypes.func\n} : {};\nexport default InnerImageZoom;","map":{"version":3,"sources":["C:/Users/adoud/Desktop/ecommerce/react-ecommerce/node_modules/react-inner-image-zoom/es/InnerImageZoom/InnerImageZoom.js"],"names":["_this","React","Fragment","useCallback","useEffect","useRef","useState","PropTypes","Image","ZoomImage","FullscreenPortal","InnerImageZoom","_ref","_ref$moveType","moveType","_ref$zoomType","zoomType","src","srcSet","sizes","sources","width","height","hasSpacer","zoomSrc","_ref$zoomScale","zoomScale","zoomPreload","alt","_ref$fadeDuration","fadeDuration","fullscreenOnMobile","_ref$mobileBreakpoint","mobileBreakpoint","hideCloseButton","hideHint","className","afterZoomIn","afterZoomOut","img","zoomImg","imgProps","_useState","isActive","setIsActive","_useState2","isTouch","setIsTouch","_useState3","isZoomed","setIsZoomed","_useState4","isFullscreen","setIsFullscreen","_useState5","isDragging","setIsDragging","_useState6","isValidDrag","setIsValidDrag","_useState7","currentMoveType","setCurrentMoveType","_useState8","left","setLeft","_useState9","top","setTop","handleMouseEnter","e","handleClick","handleTouchStart","getFullscreenStatus","handleClose","zoomOut","current","handleLoad","target","zoomIn","pageX","pageY","onLoadCallback","bind","scaledDimensions","getScaledDimensions","setAttribute","bounds","getBounds","ratios","getRatios","handleMouseMove","offsets","x","y","Math","max","min","handleDragStart","getOffsets","changedTouches","offsetLeft","offsetTop","eventPosition","handleDragMove","handleDragEnd","moveX","abs","moveY","handleMouseLeave","setTimeout","getDefaults","initialMove","window","pageXOffset","pageYOffset","initialDrag","initialPageX","initialPageY","innerWidth","innerHeight","preventDefault","stopPropagation","callback","getBoundingClientRect","dimensions","matchMedia","matches","naturalWidth","naturalHeight","zoomImageProps","onLoad","onDragStart","onDragEnd","onClose","eventType","addEventListener","passive","removeEventListener","createElement","style","ref","onTouchStart","onClick","onMouseEnter","onMouseMove","onMouseLeave","propTypes","process","env","NODE_ENV","string","isRequired","array","number","bool","func"],"mappings":"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","sourcesContent":["var _this = this;\n\nimport React, { Fragment, useCallback, useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport Image from './components/Image';\nimport ZoomImage from './components/ZoomImage';\nimport FullscreenPortal from './components/FullscreenPortal';\n\nvar InnerImageZoom = function InnerImageZoom(_ref) {\n  var _ref$moveType = _ref.moveType,\n      moveType = _ref$moveType === void 0 ? 'pan' : _ref$moveType,\n      _ref$zoomType = _ref.zoomType,\n      zoomType = _ref$zoomType === void 0 ? 'click' : _ref$zoomType,\n      src = _ref.src,\n      srcSet = _ref.srcSet,\n      sizes = _ref.sizes,\n      sources = _ref.sources,\n      width = _ref.width,\n      height = _ref.height,\n      hasSpacer = _ref.hasSpacer,\n      zoomSrc = _ref.zoomSrc,\n      _ref$zoomScale = _ref.zoomScale,\n      zoomScale = _ref$zoomScale === void 0 ? 1 : _ref$zoomScale,\n      zoomPreload = _ref.zoomPreload,\n      alt = _ref.alt,\n      _ref$fadeDuration = _ref.fadeDuration,\n      fadeDuration = _ref$fadeDuration === void 0 ? 150 : _ref$fadeDuration,\n      fullscreenOnMobile = _ref.fullscreenOnMobile,\n      _ref$mobileBreakpoint = _ref.mobileBreakpoint,\n      mobileBreakpoint = _ref$mobileBreakpoint === void 0 ? 640 : _ref$mobileBreakpoint,\n      hideCloseButton = _ref.hideCloseButton,\n      hideHint = _ref.hideHint,\n      className = _ref.className,\n      afterZoomIn = _ref.afterZoomIn,\n      afterZoomOut = _ref.afterZoomOut;\n  var img = useRef(null);\n  var zoomImg = useRef(null);\n  var imgProps = useRef({});\n\n  var _useState = useState(zoomPreload),\n      isActive = _useState[0],\n      setIsActive = _useState[1];\n\n  var _useState2 = useState(false),\n      isTouch = _useState2[0],\n      setIsTouch = _useState2[1];\n\n  var _useState3 = useState(false),\n      isZoomed = _useState3[0],\n      setIsZoomed = _useState3[1];\n\n  var _useState4 = useState(false),\n      isFullscreen = _useState4[0],\n      setIsFullscreen = _useState4[1];\n\n  var _useState5 = useState(false),\n      isDragging = _useState5[0],\n      setIsDragging = _useState5[1];\n\n  var _useState6 = useState(false),\n      isValidDrag = _useState6[0],\n      setIsValidDrag = _useState6[1];\n\n  var _useState7 = useState(moveType),\n      currentMoveType = _useState7[0],\n      setCurrentMoveType = _useState7[1];\n\n  var _useState8 = useState(0),\n      left = _useState8[0],\n      setLeft = _useState8[1];\n\n  var _useState9 = useState(0),\n      top = _useState9[0],\n      setTop = _useState9[1];\n\n  var handleMouseEnter = function handleMouseEnter(e) {\n    setIsActive(true);\n    zoomType === 'hover' && !isZoomed && handleClick(e);\n  };\n\n  var handleTouchStart = function handleTouchStart() {\n    setIsTouch(true);\n    setIsFullscreen(getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint));\n    setCurrentMoveType('drag');\n  };\n\n  var handleClick = function handleClick(e) {\n    if (isZoomed) {\n      if (isTouch) {\n        hideCloseButton && handleClose();\n      } else {\n        !isValidDrag && zoomOut();\n      }\n\n      return;\n    }\n\n    isTouch && setIsActive(true);\n\n    if (zoomImg.current) {\n      handleLoad({\n        target: zoomImg.current\n      });\n      zoomIn(e.pageX, e.pageY);\n    } else {\n      imgProps.current.onLoadCallback = zoomIn.bind(_this, e.pageX, e.pageY);\n    }\n  };\n\n  var handleLoad = function handleLoad(e) {\n    var scaledDimensions = getScaledDimensions(e.target, zoomScale);\n    zoomImg.current = e.target;\n    zoomImg.current.setAttribute('width', scaledDimensions.width);\n    zoomImg.current.setAttribute('height', scaledDimensions.height);\n    imgProps.current.scaledDimensions = scaledDimensions;\n    imgProps.current.bounds = getBounds(img.current, false);\n    imgProps.current.ratios = getRatios(imgProps.current.bounds, scaledDimensions);\n\n    if (imgProps.current.onLoadCallback) {\n      imgProps.current.onLoadCallback();\n      imgProps.current.onLoadCallback = null;\n    }\n  };\n\n  var handleMouseMove = function handleMouseMove(e) {\n    var left = e.pageX - imgProps.current.offsets.x;\n    var top = e.pageY - imgProps.current.offsets.y;\n    left = Math.max(Math.min(left, imgProps.current.bounds.width), 0);\n    top = Math.max(Math.min(top, imgProps.current.bounds.height), 0);\n    setLeft(left * -imgProps.current.ratios.x);\n    setTop(top * -imgProps.current.ratios.y);\n  };\n\n  var handleDragStart = function handleDragStart(e) {\n    imgProps.current.offsets = getOffsets(e.pageX || e.changedTouches[0].pageX, e.pageY || e.changedTouches[0].pageY, zoomImg.current.offsetLeft, zoomImg.current.offsetTop);\n    setIsDragging(true);\n\n    if (!isTouch) {\n      imgProps.current.eventPosition = {\n        x: e.pageX,\n        y: e.pageY\n      };\n    }\n  };\n\n  var handleDragMove = useCallback(function (e) {\n    var left = (e.pageX || e.changedTouches[0].pageX) - imgProps.current.offsets.x;\n    var top = (e.pageY || e.changedTouches[0].pageY) - imgProps.current.offsets.y;\n    left = Math.max(Math.min(left, 0), (imgProps.current.scaledDimensions.width - imgProps.current.bounds.width) * -1);\n    top = Math.max(Math.min(top, 0), (imgProps.current.scaledDimensions.height - imgProps.current.bounds.height) * -1);\n    setLeft(left);\n    setTop(top);\n  }, []);\n\n  var handleDragEnd = function handleDragEnd(e) {\n    setIsDragging(false);\n\n    if (!isTouch) {\n      var moveX = Math.abs(e.pageX - imgProps.current.eventPosition.x);\n      var moveY = Math.abs(e.pageY - imgProps.current.eventPosition.y);\n      setIsValidDrag(moveX > 5 || moveY > 5);\n    }\n  };\n\n  var handleMouseLeave = function handleMouseLeave(e) {\n    currentMoveType === 'drag' && isZoomed ? handleDragEnd(e) : handleClose();\n  };\n\n  var handleClose = function handleClose() {\n    zoomOut(function () {\n      setTimeout(function () {\n        if (zoomPreload && isTouch || !zoomPreload) {\n          zoomImg.current = null;\n          imgProps.current = getDefaults();\n          setIsActive(false);\n        }\n\n        setIsTouch(false);\n        setIsFullscreen(false);\n        setCurrentMoveType(moveType);\n      }, isFullscreen ? 0 : fadeDuration);\n    });\n  };\n\n  var initialMove = function initialMove(pageX, pageY) {\n    imgProps.current.offsets = getOffsets(window.pageXOffset, window.pageYOffset, -imgProps.current.bounds.left, -imgProps.current.bounds.top);\n    handleMouseMove({\n      pageX: pageX,\n      pageY: pageY\n    });\n  };\n\n  var initialDrag = function initialDrag(pageX, pageY) {\n    var initialPageX = (pageX - (window.pageXOffset + imgProps.current.bounds.left)) * -imgProps.current.ratios.x;\n    var initialPageY = (pageY - (window.pageYOffset + imgProps.current.bounds.top)) * -imgProps.current.ratios.y;\n    initialPageX = initialPageX + (isFullscreen ? (window.innerWidth - imgProps.current.bounds.width) / 2 : 0);\n    initialPageY = initialPageY + (isFullscreen ? (window.innerHeight - imgProps.current.bounds.height) / 2 : 0);\n    imgProps.current.bounds = getBounds(img.current, isFullscreen);\n    imgProps.current.offsets = getOffsets(0, 0, 0, 0);\n    handleDragMove({\n      changedTouches: [{\n        pageX: initialPageX,\n        pageY: initialPageY\n      }],\n      preventDefault: function preventDefault() {},\n      stopPropagation: function stopPropagation() {}\n    });\n  };\n\n  var zoomIn = function zoomIn(pageX, pageY) {\n    setIsZoomed(true);\n    currentMoveType === 'drag' ? initialDrag(pageX, pageY) : initialMove(pageX, pageY);\n    afterZoomIn && afterZoomIn();\n  };\n\n  var zoomOut = function zoomOut(callback) {\n    setIsZoomed(false);\n    afterZoomOut && afterZoomOut();\n    callback && callback();\n  };\n\n  var getDefaults = function getDefaults() {\n    return {\n      onLoadCallback: null,\n      bounds: {},\n      offsets: {},\n      ratios: {},\n      eventPosition: {},\n      scaledDimensions: {}\n    };\n  };\n\n  var getBounds = function getBounds(img, isFullscreen) {\n    if (isFullscreen) {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        left: 0,\n        top: 0\n      };\n    }\n\n    return img.getBoundingClientRect();\n  };\n\n  var getOffsets = function getOffsets(pageX, pageY, left, top) {\n    return {\n      x: pageX - left,\n      y: pageY - top\n    };\n  };\n\n  var getRatios = function getRatios(bounds, dimensions) {\n    return {\n      x: (dimensions.width - bounds.width) / bounds.width,\n      y: (dimensions.height - bounds.height) / bounds.height\n    };\n  };\n\n  var getFullscreenStatus = function getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint) {\n    return fullscreenOnMobile && window.matchMedia && window.matchMedia(\"(max-width: \" + mobileBreakpoint + \"px)\").matches;\n  };\n\n  var getScaledDimensions = function getScaledDimensions(zoomImg, zoomScale) {\n    return {\n      width: zoomImg.naturalWidth * zoomScale,\n      height: zoomImg.naturalHeight * zoomScale\n    };\n  };\n\n  var zoomImageProps = {\n    src: zoomSrc || src,\n    fadeDuration: isFullscreen ? 0 : fadeDuration,\n    top: top,\n    left: left,\n    isZoomed: isZoomed,\n    onLoad: handleLoad,\n    onDragStart: currentMoveType === 'drag' ? handleDragStart : null,\n    onDragEnd: currentMoveType === 'drag' ? handleDragEnd : null,\n    onClose: !hideCloseButton && isTouch ? handleClose : null\n  };\n  useEffect(function () {\n    imgProps.current = getDefaults();\n  }, []);\n  useEffect(function () {\n    getFullscreenStatus(fullscreenOnMobile, mobileBreakpoint) && setIsActive(false);\n  }, [fullscreenOnMobile, mobileBreakpoint]);\n  useEffect(function () {\n    if (!zoomImg.current) {\n      return;\n    }\n\n    var eventType = isTouch ? 'touchmove' : 'mousemove';\n\n    if (isDragging) {\n      zoomImg.current.addEventListener(eventType, handleDragMove, {\n        passive: true\n      });\n    } else {\n      zoomImg.current.removeEventListener(eventType, handleDragMove);\n    }\n  }, [isDragging, isTouch, handleDragMove]);\n  return /*#__PURE__*/React.createElement(\"figure\", {\n    className: \"iiz \" + (currentMoveType === 'drag' ? 'iiz--drag' : '') + \" \" + (className ? className : ''),\n    style: {\n      width: width\n    },\n    ref: img,\n    onTouchStart: isZoomed ? null : handleTouchStart,\n    onClick: handleClick,\n    onMouseEnter: isTouch ? null : handleMouseEnter,\n    onMouseMove: currentMoveType === 'drag' || !isZoomed ? null : handleMouseMove,\n    onMouseLeave: isTouch ? null : handleMouseLeave\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: src,\n    srcSet: srcSet,\n    sizes: sizes,\n    sources: sources,\n    width: width,\n    height: height,\n    hasSpacer: hasSpacer,\n    alt: alt,\n    fadeDuration: fadeDuration,\n    isZoomed: isZoomed\n  }), isActive && /*#__PURE__*/React.createElement(Fragment, null, isFullscreen ? /*#__PURE__*/React.createElement(FullscreenPortal, null, /*#__PURE__*/React.createElement(ZoomImage, zoomImageProps)) : /*#__PURE__*/React.createElement(ZoomImage, zoomImageProps)), !hideHint && !isZoomed && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"iiz__btn iiz__hint\"\n  }));\n};\n\nInnerImageZoom.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  moveType: PropTypes.string,\n  zoomType: PropTypes.string,\n  src: PropTypes.string.isRequired,\n  srcSet: PropTypes.string,\n  sizes: PropTypes.string,\n  sources: PropTypes.array,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  hasSpacer: PropTypes.bool,\n  zoomSrc: PropTypes.string,\n  zoomScale: PropTypes.number,\n  zoomPreload: PropTypes.bool,\n  alt: PropTypes.string,\n  fadeDuration: PropTypes.number,\n  fullscreenOnMobile: PropTypes.bool,\n  mobileBreakpoint: PropTypes.number,\n  hideCloseButton: PropTypes.bool,\n  hideHint: PropTypes.bool,\n  className: PropTypes.string,\n  afterZoomIn: PropTypes.func,\n  afterZoomOut: PropTypes.func\n} : {};\nexport default InnerImageZoom;"]},"metadata":{},"sourceType":"module"}